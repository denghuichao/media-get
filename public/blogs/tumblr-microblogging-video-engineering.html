<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tumblr Microblogging Video Engineering - yt-dlp Deep Dive</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }

        .header {
            background: linear-gradient(135deg, #00cf35, #001935);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 207, 53, 0.3);
        }

        .header h1 {
            margin: 0;
            font-size: 2.8em;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            margin: 15px 0 0 0;
            font-size: 1.2em;
            opacity: 0.95;
        }

        .content-section {
            background: white;
            margin: 30px 0;
            padding: 35px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #00cf35;
        }

        .content-section h2 {
            color: #00cf35;
            font-size: 2em;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 3px solid #00cf35;
        }

        .content-section h3 {
            color: #001935;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 25px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid #00cf35;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            line-height: 1.5;
        }

        .architecture-diagram {
            background: linear-gradient(45deg, #f0fff0, #e6ffe6);
            padding: 30px;
            border-radius: 10px;
            margin: 25px 0;
            border: 2px solid #00cf35;
            text-align: center;
        }

        .flow-step {
            background: white;
            margin: 15px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #00cf35;
            display: inline-block;
            min-width: 200px;
        }

        .api-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
        }

        .api-table th {
            background: #00cf35;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .api-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .api-table tr:hover {
            background: #f9f9f9;
        }

        .highlight {
            background: linear-gradient(120deg, #e6ffe6 0%, #f0fff0 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #00cf35;
            margin: 20px 0;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .tech-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-top: 4px solid #00cf35;
            text-align: center;
        }

        .metric-card {
            background: linear-gradient(135deg, #00cf35, #001935);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(0, 207, 53, 0.3);
        }

        .metric-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .challenge-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #f39c12;
        }

        .pro-tip {
            background: #d1ecf1;
            border: 1px solid #b8daff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }

        .provider-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .provider-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-top: 4px solid #00cf35;
        }

        .auth-flow {
            background: linear-gradient(45deg, #fff9e6, #ffe6cc);
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border: 2px solid #ff9500;
        }
    
.blog-navigation {
    margin: 20px 0;
    text-align: center;
}

.blog-index-link {
    display: inline-block;
    padding: 10px 20px;
    background-color: #85C341;
    color: white;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    transition: background-color 0.3s;
}

.blog-index-link:hover {
    background-color: #6c9a33;
}
</style>
</head>

<body>
    <div class="header">
        <h1>üé® Tumblr Microblogging Video Engineering</h1>
<div class="blog-navigation">
    <a href="/#blogs" class="blog-index-link">‚Üê Back to Blog Index</a>
</div>

        <p>Deep Dive into yt-dlp's Multi-Provider Content Extraction & OAuth2 Authentication</p>
    </div>

    <div class="content-section">
        <h2>üéØ Executive Summary</h2>
        <p>Tumblr presents one of the most complex video extraction challenges in social media, supporting both native
            video hosting and embedded content from multiple external providers. This analysis explores yt-dlp's
            sophisticated approach to handling Tumblr's diverse content ecosystem, including OAuth2 authentication,
            multi-provider detection, dashboard-only posts, and comprehensive metadata extraction.</p>

        <div class="highlight">
            <strong>Key Engineering Insights:</strong> Tumblr's extractor implements a dual-strategy approach with
            API-based authenticated access for dashboard content and webpage scraping for public posts, combined with
            intelligent provider detection for embedded content.
        </div>
    </div>

    <div class="content-section">
        <h2>üèóÔ∏è Tumblr Platform Architecture</h2>

        <div class="architecture-diagram">
            <h3>Tumblr Multi-Provider Extraction Flow</h3>
            <div class="flow-step">
                <strong>1. URL Analysis</strong><br>
                Blog & Post ID Extraction<br>
                <code>{blog}.tumblr.com/post/{id}</code>
            </div>
            <div class="flow-step">
                <strong>2. Access Strategy</strong><br>
                API vs Webpage Detection<br>
                Dashboard-only vs Public Content
            </div>
            <div class="flow-step">
                <strong>3. Authentication</strong><br>
                OAuth2 Token Management<br>
                2FA Support & Bearer Headers
            </div>
            <div class="flow-step">
                <strong>4. Provider Detection</strong><br>
                Native vs External Content<br>
                Multi-Provider Support
            </div>
            <div class="flow-step">
                <strong>5. Format Extraction</strong><br>
                HD/SD Quality Detection<br>
                Iframe Processing
            </div>
        </div>

        <div class="tech-stack">
            <div class="tech-item">
                <h4>üîê Authentication</h4>
                <p>OAuth2 Password Grant Flow</p>
                <code>Bearer Token + 2FA Support</code>
            </div>
            <div class="tech-item">
                <h4>üåê Multi-Provider</h4>
                <p>8+ External Video Hosts</p>
                <code>YouTube, Vimeo, Instagram, TikTok</code>
            </div>
            <div class="tech-item">
                <h4>üì± Content Types</h4>
                <p>Native Videos, Embeds, Audio</p>
                <code>video, audio, playlist</code>
            </div>
            <div class="tech-item">
                <h4>üîß API Integration</h4>
                <p>Tumblr v2 API</p>
                <code>/api/v2/blog/{blog}/posts/{id}</code>
            </div>
        </div>
    </div>

    <div class="content-section">
        <h2>üíª Core Implementation Analysis</h2>

        <h3>üéØ URL Pattern Recognition & Blog Detection</h3>
        <div class="code-block">
            # Complex URL pattern for multiple Tumblr formats
            _VALID_URL =
            r'https?://(?P<blog_name_1>[^/?#&]+)\.tumblr\.com/(?:post|video|(?P<blog_name_2>[a-zA-Z\d-]+))/(?P<id>[0-9]+)(?:$|[/?#])'

            # Support for new URL scheme
            # https://www.tumblr.com/{blog}/{id}?source=share

            # Blog name extraction with fallback
            blog_1, blog_2, video_id = self._match_valid_url(url).groups()
            blog = blog_2 or blog_1
        </div>

        <h3>üîê OAuth2 Authentication Implementation</h3>
        <div class="auth-flow">
            <h4>Advanced Authentication Flow</h4>
            <div class="code-block">
                def _perform_login(self, username, password):
                data = {
                'password': password,
                'grant_type': 'password',
                'username': username,
                }

                # Two-factor authentication support
                if self.get_param('twofactor'):
                data['tfa_token'] = self.get_param('twofactor')

                response = self._download_json(
                self._OAUTH_URL, None, 'Logging in',
                data=urlencode_postdata(data),
                headers={
                'Content-Type': 'application/x-www-form-urlencoded',
                'Authorization': f'Bearer {self._ACCESS_TOKEN}',
                })

                # Handle 2FA requirement
                if traverse_obj(response, 'error') == 'tfa_required':
                data['tfa_token'] = self._get_tfa_info()
                response = _call_login()
            </div>
        </div>

        <h3>üé• Multi-Provider Content Detection</h3>
        <div class="code-block">
            # Comprehensive provider mapping
            _providers = {
            'instagram': 'Instagram',
            'vimeo': 'Vimeo',
            'youtube': 'Youtube',
            'dailymotion': 'Dailymotion',
            'tiktok': 'TikTok',
            'twitch_live': 'TwitchStream',
            'bandcamp': None,
            'soundcloud': None,
            }

            # Provider-based content extraction
            for video_json in traverse_obj(content_json, lambda _, v: v['type'] in ('video', 'audio')):
            provider = video_json.get('provider')

            if provider in ('tumblr', None):
            # Native Tumblr video processing
            fallback_format = {
            'url': media_json.get('url') or video_url,
            'width': int_or_none(media_json.get('width')),
            'height': int_or_none(media_json.get('height')),
            }
            elif provider in self._providers:
            # External provider delegation
            entries.append(self.url_result(
            video_json['url'], self._providers.get(provider)))
        </div>

        <h3>üîß Iframe & Quality Detection</h3>
        <div class="code-block">
            # Advanced iframe processing for quality variants
            iframe_url = self._search_regex(
            fr'src=\'(https?://www\.tumblr\.com/video/{blog}/{video_id}/[^\']+)\'',
            webpage, 'iframe url', default=None)

            if iframe_url:
            options = self._parse_json(
            self._search_regex(
            r'data-crt-options=(["\'])(?P<options>.+?)\1', iframe,
            'hd video url', default='', group='options'))

            if options:
            duration = int_or_none(options.get('duration'))
            hd_url = options.get('hdUrl')

            # Multiple quality extraction
            sources = []
            sd_url = self._search_regex(
            r'<source[^>]+src=(["\'])(?P<url>.+?)\1', iframe,
            'sd video url', default=None, group='url')
            if sd_url:
            sources.append((sd_url, 'sd'))
            sources.append((hd_url, 'hd'))
        </div>
    </div>

    <div class="content-section">
        <h2>üìä Tumblr API Data Structure</h2>

        <table class="api-table">
            <thead>
                <tr>
                    <th>API Endpoint</th>
                    <th>Data Type</th>
                    <th>Description</th>
                    <th>Authentication</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>/api/v2/blog/{blog}/posts/{id}/permalink</code></td>
                    <td>Post Data</td>
                    <td>Complete post metadata and content</td>
                    <td>Bearer Token Required</td>
                </tr>
                <tr>
                    <td><code>response.timeline.elements[0]</code></td>
                    <td>Post Object</td>
                    <td>Main post content structure</td>
                    <td>Authenticated Access</td>
                </tr>
                <tr>
                    <td><code>trail[0].content</code></td>
                    <td>Content Array</td>
                    <td>Original post content blocks</td>
                    <td>API Access</td>
                </tr>
                <tr>
                    <td><code>content[].type</code></td>
                    <td>Content Type</td>
                    <td>video, audio, text content types</td>
                    <td>API Access</td>
                </tr>
                <tr>
                    <td><code>content[].provider</code></td>
                    <td>Video Provider</td>
                    <td>tumblr, youtube, vimeo, etc.</td>
                    <td>API Access</td>
                </tr>
            </tbody>
        </table>

        <h3>üé≠ Content Type Detection Matrix</h3>
        <table class="api-table">
            <thead>
                <tr>
                    <th>Content Type</th>
                    <th>Provider</th>
                    <th>Extraction Method</th>
                    <th>Quality Options</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Native Video</td>
                    <td>tumblr/null</td>
                    <td>Direct URL + Iframe</td>
                    <td>SD/HD variants</td>
                </tr>
                <tr>
                    <td>YouTube Embed</td>
                    <td>youtube</td>
                    <td>url_transparent delegation</td>
                    <td>Full YouTube quality range</td>
                </tr>
                <tr>
                    <td>Vimeo Embed</td>
                    <td>vimeo</td>
                    <td>url_transparent delegation</td>
                    <td>Vimeo quality options</td>
                </tr>
                <tr>
                    <td>TikTok Embed</td>
                    <td>tiktok</td>
                    <td>url_transparent delegation</td>
                    <td>TikTok standard quality</td>
                </tr>
                <tr>
                    <td>Instagram Video</td>
                    <td>instagram</td>
                    <td>url_transparent delegation</td>
                    <td>Instagram formats</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="content-section">
        <h2>üîß Advanced Tumblr Engineering Features</h2>

        <div class="provider-grid">
            <div class="provider-card">
                <h4>üé¨ Native Tumblr Videos</h4>
                <p><strong>Direct Hosting:</strong> Tumblr's own video infrastructure</p>
                <p><strong>Quality Detection:</strong> SD/HD iframe parsing</p>
                <p><strong>Format Support:</strong> MP4 progressive download</p>
                <code>iframe: data-crt-options with hdUrl</code>
            </div>

            <div class="provider-card">
                <h4>üåê Multi-Provider Embeds</h4>
                <p><strong>Provider Detection:</strong> JSON content analysis</p>
                <p><strong>Delegation Strategy:</strong> url_transparent to specialists</p>
                <p><strong>Fallback Handling:</strong> Unsupported provider warnings</p>
                <code>_providers mapping + url_result delegation</code>
            </div>

            <div class="provider-card">
                <h4>üîí Dashboard-Only Content</h4>
                <p><strong>Access Control:</strong> OAuth2 authentication required</p>
                <p><strong>API Endpoint:</strong> v2 permalink API</p>
                <p><strong>Content Discovery:</strong> Timeline elements parsing</p>
                <code>Bearer token + API-only extraction</code>
            </div>

            <div class="provider-card">
                <h4>üéµ Audio Content Support</h4>
                <p><strong>Audio Types:</strong> SoundCloud, Bandcamp embeds</p>
                <p><strong>Playlist Support:</strong> Multi-track collections</p>
                <p><strong>Provider Handling:</strong> Specialized audio extractors</p>
                <code>content.type == 'audio' + provider delegation</code>
            </div>
        </div>
    </div>

    <div class="content-section">
        <h2>üõ°Ô∏è Anti-Detection & Access Control</h2>

        <div class="challenge-box">
            <h4>‚ö†Ô∏è Tumblr Platform Challenges</h4>
            <ul>
                <li><strong>Dashboard-Only Posts:</strong> Requires OAuth2 authentication for private/sensitive content
                </li>
                <li><strong>NSFW Content Filtering:</strong> Age gating and content restrictions</li>
                <li><strong>Multi-Provider Complexity:</strong> Different extraction strategies per embed type</li>
                <li><strong>API Rate Limiting:</strong> OAuth token management and request throttling</li>
            </ul>
        </div>

        <h3>üîê Authentication Bypass Techniques</h3>
        <div class="code-block">
            # WhatsApp User-Agent for public content bypass
            headers = {'User-Agent': 'WhatsApp/2.0'} # bypasses certain restrictions

            # API token extraction from login page
            login_page = self._download_webpage(self._LOGIN_URL, None)
            self._ACCESS_TOKEN = self._search_regex(
            r'"API_TOKEN":\s*"(\w+)"', login_page, 'API access token')

            # Dashboard-only detection
            api_only = bool(self._search_regex(
            r'(tumblr.com|^)/(safe-mode|login_required|blog/view)',
            redirect_url, 'redirect', default=None))
        </div>

        <h3>üîÑ Robust Error Handling</h3>
        <div class="code-block">
            # Provider-specific error handling
            ignored_providers = set()
            unknown_providers = set()

            for video_json in content_json:
            provider = video_json.get('provider')

            if provider in self._unsupported_providers:
            ignored_providers.add(provider)
            continue
            elif provider and provider not in self._providers:
            unknown_providers.add(provider)

            # Comprehensive error reporting
            if ignored_providers:
            self.report_warning(f'Skipped embeds from unsupported providers: {", ".join(ignored_providers)}')
            if unknown_providers:
            self.report_warning(f'Unrecognized providers, please report: {", ".join(unknown_providers)}')
        </div>
    </div>

    <div class="content-section">
        <h2>üìà Tumblr Extraction Metrics</h2>

        <div
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 25px 0;">
            <div class="metric-card">
                <div class="metric-number">8+</div>
                <div>Supported Providers</div>
            </div>
            <div class="metric-card">
                <div class="metric-number">2FA</div>
                <div>Authentication Support</div>
            </div>
            <div class="metric-card">
                <div class="metric-number">3</div>
                <div>Content Types</div>
            </div>
            <div class="metric-card">
                <div class="metric-number">OAuth2</div>
                <div>Security Protocol</div>
            </div>
        </div>

        <h3>üéØ Provider Success Rates</h3>
        <table class="api-table">
            <thead>
                <tr>
                    <th>Provider</th>
                    <th>Success Rate</th>
                    <th>Common Issues</th>
                    <th>Delegation Strategy</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Native Tumblr</td>
                    <td>95%+</td>
                    <td>Dashboard-only content</td>
                    <td>OAuth2 authentication</td>
                </tr>
                <tr>
                    <td>YouTube Embeds</td>
                    <td>90%+</td>
                    <td>YouTube restrictions</td>
                    <td>url_transparent to YouTube IE</td>
                </tr>
                <tr>
                    <td>Vimeo Embeds</td>
                    <td>85%+</td>
                    <td>Private video settings</td>
                    <td>url_transparent to Vimeo IE</td>
                </tr>
                <tr>
                    <td>TikTok Embeds</td>
                    <td>80%+</td>
                    <td>Regional restrictions</td>
                    <td>url_transparent to TikTok IE</td>
                </tr>
                <tr>
                    <td>Audio Content</td>
                    <td>88%+</td>
                    <td>Platform-specific issues</td>
                    <td>Provider-specific extractors</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="content-section">
        <h2>üöÄ Advanced Implementation Strategies</h2>

        <div class="pro-tip">
            <h4>üí° Pro Implementation Tips</h4>
            <ul>
                <li><strong>Authentication Management:</strong> Implement robust OAuth2 flow with 2FA support</li>
                <li><strong>Provider Delegation:</strong> Use url_transparent for optimal format extraction</li>
                <li><strong>Fallback Strategies:</strong> Combine API and webpage extraction methods</li>
                <li><strong>Quality Detection:</strong> Parse iframe data for HD/SD variants</li>
                <li><strong>Error Resilience:</strong> Handle unsupported providers gracefully</li>
            </ul>
        </div>

        <h3>üîÑ Content Type Processing Pipeline</h3>
        <div class="code-block">
            # Comprehensive content processing
            entries = []
            formats = []

            # Process each content block
            for video_json in traverse_obj(content_json, lambda _, v: v['type'] in ('video', 'audio')):
            provider = video_json.get('provider')

            if provider in ('tumblr', None):
            # Native content processing
            media_json = video_json.get('media') or {}
            fallback_format = {
            'url': media_json.get('url') or video_url,
            'width': int_or_none(media_json.get('width')),
            'height': int_or_none(media_json.get('height')),
            }
            formats.append(fallback_format)

            elif provider in self._providers:
            # External provider delegation
            entries.append(self.url_result(
            video_json['url'], self._providers.get(provider)))
        </div>

        <h3>üìä Metadata Enrichment Strategy</h3>
        <div class="code-block">
            # Rich metadata extraction from API and webpage
            info_dict = {
            'id': video_id,
            'title': post_json.get('summary') or self._html_search_regex(
            r'(?s)<title>(?P<title>.*?)(?: \| Tumblr)?</title>', webpage),
            'description': description,
            'uploader_id': traverse_obj(post_json, 'reblogged_root_name', 'blog_name'),
            'uploader_url': f'https://{uploader_id}.tumblr.com/',
            'like_count': traverse_obj(post_json, ('like_count', {int_or_none})),
            'repost_count': traverse_obj(post_json, ('reblog_count', {int_or_none})),
            'tags': traverse_obj(post_json, ('tags', ..., {str})),
            'age_limit': {True: 18, False: 0}.get(post_json.get('is_nsfw')),
            }
        </div>
    </div>

    <div class="content-section">
        <h2>üîÆ Future Tumblr Extraction Enhancements</h2>

        <div class="highlight">
            <h4>üöÄ Upcoming Developments</h4>
            <ul>
                <li><strong>Live Streaming Support:</strong> Tumblr Live video extraction capabilities</li>
                <li><strong>Community Posts:</strong> Enhanced community content extraction</li>
                <li><strong>Advanced Media Types:</strong> GIF sets and photo carousels with videos</li>
                <li><strong>Tumblr TV Integration:</strong> Long-form video content support</li>
                <li><strong>Creator Studio Access:</strong> Professional creator content extraction</li>
            </ul>
        </div>

        <h3>üîß Technical Roadmap</h3>
        <table class="api-table">
            <thead>
                <tr>
                    <th>Enhancement</th>
                    <th>Technical Challenge</th>
                    <th>Implementation Approach</th>
                    <th>Priority</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Tumblr Live Streams</td>
                    <td>Real-time content detection</td>
                    <td>WebSocket integration for live content</td>
                    <td>High</td>
                </tr>
                <tr>
                    <td>Multi-Media Posts</td>
                    <td>Complex nested content</td>
                    <td>Enhanced content traversal algorithms</td>
                    <td>Medium</td>
                </tr>
                <tr>
                    <td>Community Features</td>
                    <td>Group content access</td>
                    <td>Community API endpoints integration</td>
                    <td>Low</td>
                </tr>
                <tr>
                    <td>Creator Analytics</td>
                    <td>Private creator data</td>
                    <td>Enhanced authentication scopes</td>
                    <td>Medium</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="content-section">
        <h2>üéØ Conclusion</h2>
        <p>Tumblr's video extraction implementation in yt-dlp represents one of the most sophisticated multi-provider
            content extraction systems in modern video downloading. The combination of OAuth2 authentication,
            intelligent provider detection, and robust fallback mechanisms creates a comprehensive solution for Tumblr's
            diverse content ecosystem.</p>

        <p>The architecture's ability to handle both native Tumblr videos and embedded content from 8+ external
            providers, while managing dashboard-only content through API authentication, showcases advanced content
            detection and extraction capabilities. The implementation effectively balances public content accessibility
            with authenticated access for private posts.</p>

        <div class="highlight">
            <strong>Key Takeaway:</strong> Tumblr's implementation demonstrates how modern extractors must handle
            complex multi-provider environments while maintaining security through proper authentication flows and
            graceful error handling for unsupported content types.
        </div>
    </div>
</body>

</html>